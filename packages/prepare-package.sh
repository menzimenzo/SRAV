#!/bin/bash

# Shell de préparation du package de déploiement pour livraison
echo ""
echo "............................................................................................................................................"
echo "..................................................................:~~~=....................................................................."
echo ".................................................................~~~~~=~,..................................................................."
echo ".................................................................??+~=~~~..................................................................."
echo ".................................................................+~?,III~..................................................................."
echo "........................................................=  +.....II+III....................................................................."
echo "........................................................7 I7 7++=II.II,....................................................................."
echo ".......................................................7I 777,=~?+?........................................................................."
echo "......................................................7??++77=+===+........................................................................."
echo ".....................................................?77I+?7+======........................................................................."
echo ".....................................................?77777I7=++===+........................................................................"
echo "......................................................????7++=+77.II?......................................................................."
echo ".........................................................====77I+...IIII?..................................................................."
echo "........................................................~++====+.........I??................................................................"
echo "........................................................==++=+==..........,,::==,,.........................................................."
echo ".......................................................=+++====.................,+.........................................................."
echo ".......................................................++++++++................?,..........................................................."
echo "......................................................,+++???????+:............~+..........................................................."
echo ".......................................................,?+??????++++?=..........,,,:?......................................................."
echo ".........................................................?:::,+?++????........,,,,.........................................................."
echo ".......................................................+,,?=+?.....??+......,:,,.,,........................................................."
echo "......................................~==:...:=+=.........,.+?....??I.....,,,,....,,???=...................................................."
echo "...................................,=.............=.......,:,::,,:??....,,,......+,,,......................................................."
echo "......................................+=~.....===...=...,,.:?....??:,,,:,......~?..:,?,.....??=............................................."
echo "..............................=:...........=+..:....?,:...II~,,,,.......?...?,:,.........++..........................................."
echo ".............................=..............,=..=...??,...+++,,........=..~+...,..........,?.........................................."
echo "............................+............,,...=..=..+?,..77++++?.......+.~+....,,...........?........................................."
echo "...........................+........,,,,.......+.=.+~~.,,,,,..........+..?......:,,,........?........................................."
echo "...........................+.......:,,,,,......+..:I++,,,,,...........I..?......,,,,,,.......?........................................"
echo "...........................=.......:,,,,.......=......,,,,,..............?......,,,,,,.......?........................................"
echo "...===:.....:=...=......~,.=........,,,........=..=..=====,......?????=..?.......,,,,.......,+.?.....?..?.......++????..?????,........"
echo "..=.........==~...+.....=..==.................=,..=..=.....=.....+.....?.?..................+..?.....?..?.......?.......?.....?......."
echo "..=,.......=..+....=...=....+................~=...=..=.....+.....+.....+..?................?~..?.....?..?.......?.......?.....+......."
echo ".....==,..=,...=...=..::.....=~.............=~....=..=====.......+??+?=....?..............+~...?.....?..?.......?.......?????........."
echo ".......=..=..,.,=...=.=........=~.........==......=..=...=~......?...=?.....~?,.........?+.....+.....?..?.......?.......+...=?........"
echo "..=====..+......=...:+...........~=======:........=..=....,+.....?.....?.......?????+?+.........????+...??????..??????..?.....?......."
echo "......................................................................................................................................"
echo "......................................................................................................................................"
echo "...........................??????++:~,:::::::,::::,:::::::::,::::::::::::,:::::::::::,................................................"
echo "............................+????+?:,::,:,:::::::::,::,::::,::::,:::::::::,::::,::,::::,.............................................."
echo ".............................????+?:::,:,:,::77:::,::::,::,:,::,:7+:,:77:,::::,::::,::,:,............................................."
echo "..............................???+?:,::::,::,?I:::::::,?::~~~:,:I7,::,77::::77:,::,:,::,:::..........................................."
echo "..............................+????,:,::,:,,7I777:,:::+77,:77:77+~77::77::77II77:::,::::,::,,........................................."
echo "...............................????:,::::,:,77777,::::,77:77:,777777:,77,77::,:77:,:,::,::,:,........................................."
echo "..............................?????,::::,::77::77:,::,::777:::77:,,,::77:+77,:77:::,::,:,::,.........................................."
echo ".............................??????:,::,:::=77777,::::,:,77,::,7777~:,77,~,77 7:::,:,::,::............................................"
echo ".............................??????,::,:,:::~,::,~:::,:,::,:,::,::::,:,::,:,,:,::,:,::,:,............................................."
echo "............................+??????~:::::,::,::::,::,:,:,::,::,::::::,::,:,::,~,::,:,::..............................................."
echo "...........................????????,::,:,:,,:,::,:,::,:,::,:,::,:,,:,:,,:,::,:,::,:,:................................................."
echo "......................................................................................................................................"
echo ""
echo "╭━━━╮╱╱╱╱╱╱╱╱╭╮╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╭━━━╮╭━━━╮╭━━━╮╭╮╱╱╭╮"
echo "┃╭━╮┃╱╱╱╱╱╱╱╱┃┃╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱┃╭━╮┃┃╭━╮┃┃╭━╮┃┃╰╮╭╯┃"
echo "┃╰━╯┃╭━━╮╭━━╮┃┃╭╮╭━━╮╭━━╮╭╮╭━╮╱╭━━╮┃╰━━╮┃╰━╯┃┃┃╱┃┃╰╮┃┃╭╯"
echo "┃╭━━╯┃╭╮┃┃╭━╯┃╰╯╯┃╭╮┃┃╭╮┃┣┫┃╭╮╮┃╭╮┃╰━━╮┃┃╭╮╭╯┃╰━╯┃╱┃╰╯┃"
echo "┃┃╱╱╱┃╭╮┃┃╰━╮┃╭╮╮┃╭╮┃┃╰╯┃┃┃┃┃┃┃┃╰╯┃┃╰━╯┃┃┃┃╰╮┃╭━╮┃╱╰╮╭╯"
echo "╰╯╱╱╱╰╯╰╯╰━━╯╰╯╰╯╰╯╰╯╰━╮┃╰╯╰╯╰╯╰━╮┃╰━━━╯╰╯╰━╯╰╯╱╰╯╱╱╰╯"
echo "╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╭━╯┃╱╱╱╱╱╱╭━╯┃"
echo "╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╱╰━━╯╱╱╱╱╱╱╰━━╯"

echo "Pensez à modifier le numéro de version dans les fichiers suivants :"
echo " - back-end/package.json"
echo " - front-end/package.json"
echo " - front-end/components/footer.vue"
echo ""
echo "règles de nommage :"
echo " - Le fichier tar.gz est généré automatiquement et se nomme srav-x.x.x.tar.gz (x.x.x représentant le numéro de version à indiquer à l'hébergeur"
echo " - Le fichier sql et à recopier à partir du répertoire pg/scripts, il devra se nommer sql-srav-x.x.x.sql (idem pour le numéro de version"
echo ""
echo "Appuyer la touche <Entrée> pour continuer..."
read touche

echo "Copie des fichiers"
cp -r ../front-end ./
#rm -r ./front-end/node_modules
rm ./front-end/pm2.integ.json

cp -r ../back-end ./
#rm -r ./back-end/node_modules
rm ./back-end/pm2.integ.json

cp -r ../mail-server ./
#rm -r ./mail-server/node_modules
rm ./mail-server/pm2.integ.json

tar -zcvf srav-1.1.3.tar.gz  front-end back-end mail-server

echo "Suppression des répertoires temporaires"
rm -r ./front-end
rm -r ./back-end
rm -r ./mail-server

echo ""
echo "Fin des opérations"
echo "Fichier généré : "
ls -al *srav*
